<!DOCTYPE HTML>
<html lang="en">
<meta charset="UTF-8" />

<head>
  <title>News</title>

  <!-- Load d3.js also-->
  <script src="https://d3js.org/d3.v4.js"></script>

  <!-- Load d3-cloud -->
  <script src="https://cdn.jsdelivr.net/gh/holtzy/D3-graph-gallery@master/LIB/d3.layout.cloud.js"></script>
  <link rel="shortcut icon" href="#">

  <style type="text/css">
    body {
      margin: 0 auto;
      width: 860px;
      /*border: 1px solid blue;*/
      font-family: Georgia, 'Times New Roman', Times, serif;
    }

    /*p {
      overflow: hidden;
      text-overflow: ellipsis;
    }*/


    #outer_card {
      /*margin:auto;*/
      /*border: 1px solid red;*/
      box-sizing: border-box;
      width: 685px;
      height: 270px;
      margin-top: 20px;
      /*padding-top:20px;*/
      margin-left: 180px;
      /*background-color: brown;*/
      /*position: absolute;*/
      /*positioned relative to body*/
      display: none;
    }

    #cnn_news_card,
    #fox_news_card {
      /*margin:auto;*/
      /*border:1px solid red;*/
      box-sizing: border-box;
      width: 700px;
      /*height: 420px;*/
      /*UNCOMMENT*/
      /*padding-top:20px;*/
      margin-left: 165px;
      /*change to 180 if error*/
      /*background-color: green;*/
      margin-right: 230px;
      /*position: absolute;*/
      /*margin-top: 280px;*/
      display: none;
      margin-bottom: 25px;
      /*display:none;*/
      /*change*/

    }

    .column,
    .row,
    .card {
      box-sizing: border-box;
    }

    /* Float four columns side by side */
    .column {
      float: left;
      width: 25%;
      padding: 0 3px;
      display: flex;
    }

    .row {
      margin-top: 4px;
      display: flex;
    }

    /* Style the counter cards */

    .card {
      /*padding: 6px;*/
      border-radius: 5px;
      /*if changed, change in card, border_stuff, img.cnn_images*/
      background-color: #f1f1f1;
      height: 100%;

    }

    .border_stuff {
      border: 1px solid gray;
      border-radius: 5px;
      border-width: thin medium medium thin;
    }

    .mySlides {
      display: none;
    }

    img.slideshow-images {
      vertical-align: middle;
      width: 375px;
      height: 240px;
      object-fit: cover;

    }

    img.cnn_images,
    img.fox_images {
      width: 166px;
      height: 105px;
      object-fit: cover;
      border-radius: 5px;
    }

    #slideshow-container {
      float: left;
      width: 375px;
      height: 240px;
      position: relative;

      /*width: calc(100% - 180px);*/
    }

    .slideshow-content {
      position: absolute;
      bottom: 0;
      background: rgb(0, 0, 0);
      /* Fallback color */
      background: rgba(0, 0, 0, 0.5);
      /* Black background with1q 0.5 opacity */
      color: #f1f1f1;
      padding: 10px;
      height: (100%- 160px);
      width: 100%;
      /*overflow: hidden;*/
      margin-top: 40px;
      /*text-overflow: ellipsis;*/
      text-align: center;
    }

    .mySlides .slideshow-content {
      box-sizing: border-box;
    }

    .mySlides {
      margin-left: 3px;
    }

    a {
      text-decoration: none;
      color: #f1f1f1;
    }

    a.see_post {
      text-decoration: underline;
      color: blue;
      font-family: Georgia, 'Times New Roman', Times, serif;
      font-size: 12px;
    }

    div.heading_news {
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      font-family: Georgia, 'Times New Roman', Times, serif;
    }

    #cnn_heading_hr,
    #fox_heading_hr {
      border-top: 1px dotted black;
      border-bottom: none;
    }

    #wordcloud {
      float: right;
      display: none;
      background-color: #f2f2f2;
    }


    #vertical_nav_bar {
      position: absolute;
      float: left;
      /*width: 160px;*/
      width: 148px;
      height: 72px;
      /*border: 1px solid gray;*/
      position: fixed;
      
      display: block;
      cursor: pointer;

    }

    #other_nav_bar {
      position: absolute;
      float: left;
      /*width: 160px;*/
      width: 148px;
      height: 72px;
      margin-top: 20px;
      display: block;
      position: fixed;
      
      /*border: 1px solid gray;*/
      cursor: pointer;
    }


    #vertical_nav_bar button,
    #other_nav_bar button {

      float: left;
      padding: 10px 24px;
      /* Some padding */
      cursor: pointer;
      /* Pointer/hand icon */
      width: 100%;
      /* Set a width if needed */
      font-family: Georgia, 'Times New Roman', Times, serif;
      font-size: 15px;
      
     /*border: 0.5px solid gray;
      border-radius: 2px;*/
      /*display: block;*/
      /* Make the buttons appear below each other */

    }
    #search_button{
      border-radius: 2px;
      border-top: none;
      border-left: 1px solid gray;
      border-right: 1px solid gray;
      border-bottom:1px solid gray;
    }
    #news_button{
      border-radius: 2px;
      border-top: 1px solid gray;
      border-left: 1px solid gray;
      border-right: 1px solid gray;
      border-bottom:none;
    }


    #vertical_nav_bar button.active,
    #other_nav_bar button.active {
      background-color: #555;
      color: white;
    }

    /* Add a background color on hover */
    #vertical_nav_bar button:hover,
    #other_nav_bar button:hover{
      background-color: #4CAF50;
      color: white;
    }


    #search_form {
      font-family: Georgia, 'Times New Roman', Times, serif;
      border-radius: 5px;
      background-color: #f2f2f2;
      padding: 17px;
      position: absolute;
      margin-left: 190px;
      width: 628px;
      height: 110px;
      margin-top: 23px;
    }

    #search_keyword,
    #search_from,
    #category,
    #source,
    #search_to {
      margin-left: 7px;
      margin-right: 7px;

    }

    #search_keyword,
    #search_from,
    #search_to {
      width: 20%;

    }

    select {
      text-align: center;
    }


    #news_articles {
      border-radius: 5px;
      /*background-color: #ff55ff;*/
      /*uncomment*/
      padding: 5px;
      position: absolute;
      margin-left: 235px;
      margin-right: 180px;
      width: 570px;
      /*height: 700px;*/
      margin-top: 185px;
      /*border:1px solid red; */
    }

    #news_wrapper {
      border: 10px solid #556755;
    }

    .each_article {
      border-radius: 5px;
      background-color: #f2f2f2;
      /*padding: 10px;*/

      margin-left: 0px;
      margin-right: 14px;
      width: 567px;
      /*height: 100px;*/
      display: flex;
      margin-bottom: 12px;
      cursor: pointer;
      /*margin-top:150px;*/
      border: 1px solid gray;
    }

    .each_article:hover {

      box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
    }


    img.images_for_search {
      width: 65px;
      height: 65px;
      /*padding: 10px;*/

    }

    .cardcontent {
      float: left;
      padding: 15px;
      /*height: 100px;*/
    }
    .textRight{
      padding-top:12px;
      padding-left:18px;
    }

    .imgLeft {
      width: 15%;
    }

    .textRight {
      width: 80%;
    }

    .each_article,
    .cardcontent,
    .imgLeft,
    .textRight {
      box-sizing: border-box;
    }

    div.titleCard {
      font-size: 14px;
      font-weight: bold;
      line-height: 1.5;
      padding-right: 5px;
      
      /*border: 1px solid green;*/
      width: (100%-120px);

    }

    div.descCard {
      font-size: 12px;
      /*height:15px;/* to allow for characters like g to be printed*/
      white-space: nowrap;
      /*overflow: hidden;
      text-overflow: ellipsis;*/
      /*border: 1px solid blue;*/
      /*width: (100%-120px);*/
      padding-right: 5px;
      padding-top:3px;
    }


    div.authorCard,
    div.sourceCard,
    div.dateCard {
      font-size: 12px;
      font-family: Georgia, 'Times New Roman', Times, serif;
      line-height: 1.5;
    }

    /*
div.search_content{
  font-family: Georgia, 'Times New Roman', Times, serif;
  font-weight: bold;
  font-size: 14px;
  position:absolute;
  border:1px solid red;
  padding-top: 15px;
}
*/
    span.asterick_required {
      color: red;
    }

    .required_fields,
    .select_fields {
      margin-bottom: 20px;
    }

    .select_fields {
      margin-left: 55px;
      margin-right: 60px;
      padding-left: 70px;
    }
    #button1, #button2{
      background-color: #eaeae1;
      /*font-family: Georgia, 'Times New Roman', Times, serif;*/
      font-family: Arial, Helvetica, sans-serif;
    
    text-align: center;
    text-decoration: none;
    cursor: pointer;
    border: none;
    outline: none;
    padding-left:10px;
    padding-right:10px;
    padding-top:4px;
    padding-bottom: 4px;
    
    }


    #button1,
    #button2 {
      display: inline-block;
    }

    #button1 {
      margin-right: 25px;
      margin-left: 255px;
    }

    #button2 {
      margin-right: 200px;
    }

    #button1:hover,
    #button2:hover {
      color: white;
      background-color: #4CAF50;
    }

    select {
      width: 120px;
    }

    .show_button {
      padding: 5px 12px;
      text-align: center;
      text-decoration: none;
      font-size: 12px;
      font-family: Arial, Helvetica, sans-serif;
      /*font-family: Georgia, 'Times New Roman', Times, serif;*/
      background-color: #eaeae1;
      color: black;
      cursor: pointer;
      border: none;
      margin-left: 238px;
      margin-right: 200px;
      height: 25px;
    }

    .show_button:hover {
      background-color: #4CAF50;
      color: white;
    }

    b {
      font-size: 12px;
      font-family: Georgia, 'Times New Roman', Times, serif;
    }

    .close {
      cursor: pointer;
      position: absolute;
      right: 0%;
      font-size: 25px;
      padding-right: 18px;
      padding-left: 18px;
      padding-top: 8px;
      padding-bottom: 0px;
      transform: translate(0%, -50%);
      display: none;
    }

    .close:active {
      color: red;
    }
  </style>

</head>

<body>
  <script>
    function getData(news_type, no_of_articles) {
      var headline_articles = news_type.articles
      var all_author, all_desc, all_title, all_url, all_urlToImage, all_publishedAt, all_source, all_content
      var all_news_count = 0
      var src_name, src_id

      var authors = []
      var desc = []
      var titles = []
      var urls = []
      var urlToImages = []
      var published = []
      var source_names = []
      var src_ids = []
      var contents = []

      for (var i = 0; i < headline_articles.length; i++) {
        if (all_news_count >= no_of_articles) {
          break
        }
        all_flag = 1
        all_author = headline_articles[i].author;
        if (!all_author || all_author.length == 0 || all_author == "null") {
          all_flag = 0
          continue
        }


        all_desc = headline_articles[i].description
        if (!all_desc || all_desc.length == 0 || all_desc == "null") {
          all_flag = 0
          continue
        }
        all_title = headline_articles[i].title
        if (!all_title || all_title.length == 0 || all_title == "null") {
          all_flag = 0
          continue
        }
        all_url = headline_articles[i].url
        if (!all_url || all_url.length == 0 || all_url == "null") {
          all_flag = 0
          continue
        }
        all_urlToImage = headline_articles[i].urlToImage
        if (!all_urlToImage || all_urlToImage.length == 0 || all_urlToImage == "null") {
          all_flag = 0
          continue
        }

        all_publishedAt = headline_articles[i].publishedAt
        if (!all_publishedAt || all_publishedAt.length == 0 || all_publishedAt == "null") {
          all_flag = 0
          continue
        }

        all_source = headline_articles[i].source
        src_flag = 1
        /*src_id=all_source.id
        if (!src_id || src_id.length==0){
            src_flag=0
            continue
        }*/
        src_name = all_source.name
        if (!src_name || src_name.length == 0 || src_name == "null") {
          src_flag = 0
          continue
        }
        all_content = headline_articles[i].content
        if (all_flag == 1 && src_flag == 1) {
          /*insert only if not already in the array*/
          /*basically dont insert any duplicate news*/
          ref_index = authors.indexOf(all_author)
          flag = 1

          if (ref_index != -1) {
            if (ref_index == desc.indexOf(all_desc)
              && ref_index == titles.indexOf(all_title)
              && ref_index == urls.indexOf(all_url)
              && ref_index == urlToImages.indexOf(all_urlToImage)
              && ref_index == published.indexOf(all_publishedAt)
              && ref_index == source_names.indexOf(src_name)) {
             
              flag = 0
            }
          }
          if (flag == 1) {
            all_news_count = all_news_count + 1

            authors.push(all_author)
            desc.push(all_desc)
            titles.push(all_title)
            urls.push(all_url)
            urlToImages.push(all_urlToImage)
            published.push(all_publishedAt)
            source_names.push(src_name)
            src_ids.push(src_id)
            contents.push(all_content)
          }
        }
      }
      var result_arr = [authors, desc, titles, urls, urlToImages, published, source_names, src_ids, contents]

      return result_arr

    }
    function showSlides(slideIndex) {
      var i;
      var slides = document.getElementsByClassName("mySlides");
      //console.log(slides.length);

      for (i = 0; i < slides.length; i++) {
        //console.log(slides[i]);
        slides[i].style.display = "none";
      }
      slideIndex++;
      if (slideIndex > slides.length) { slideIndex = 1 }

      slides[slideIndex - 1].style.display = "block";

      setTimeout(showSlides, 3500, slideIndex); // Change image every 4 seconds
    }

    function getDate() {
      //get today's date
      var date = new Date();
      var day = date.getDate();
      var month = date.getMonth() + 1;
      var year = date.getFullYear();

      if (month < 10) month = "0" + month;
      if (day < 10) day = "0" + day;

      var today = year + "/" + month + "/" + day;
      document.getElementById("search_to").valueAsDate = new Date(today);


      //get last week's date
      var days = 7; // Days you want to subtract                  
      var last = new Date(date.getTime() - (days * 24 * 60 * 60 * 1000));
      day = last.getDate();
      month = last.getMonth() + 1;
      year = last.getFullYear();
      if (month < 10) month = "0" + month;
      if (day < 10) day = "0" + day;
      var last_week = year + "/" + month + "/" + day;
      //month+"/"+day+"/"+year
      document.getElementById("search_from").valueAsDate = new Date(last_week);
      //console.log(last_week)
      //console.log(document.getElementById("search_from").value)
      //return [today, last_week]
    }

    function populateSources() {
      var url = "/search"
      //url = url + "?" + "category=" + query_keyword + "&from_date=" + from_parameter + "&to_date=" + to_parameter + "&source_news=" + source
      var search_category = document.getElementById("category").value
      if (search_category != "all") {
        url = url + "?category=" + search_category
      }
      //category_wise_sources={}
      xmlhttp = new XMLHttpRequest();

      xmlhttp.open("GET", url, true);
      xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xmlhttp.onreadystatechange = function () {
        //console.log(xmlhttp.readyState, "status")
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
          try {
            //console.log(xmlhttp.responseText)
            category_wise_sources = JSON.parse(xmlhttp.responseText)
            //console.log(category_wise_sources)
            var s1 = document.getElementById("category");
            var s2 = document.getElementById("source");
            var val = s1.value
            s2.innerHTML = "";
            var optionSet = new Set()
            var optionArray = []
            if (category_wise_sources) {
              sources = category_wise_sources.sources
              //console.log(sources.length)
              if (sources.length > 10) {
                total_times = 10
              }
              else {
                total_times = sources.length
              }
              for (i = 0; i < total_times; i++) {
                //console.log(sources[i].name)
                optionSet.add("all|all")
                if (sources[i].name) {
                  optionSet.add(sources[i].id + "|" + sources[i].name)
                }
                optionArray = Array.from(optionSet)
              }
              //console.log(optionArray)


              for (var option in optionArray) {
                var pair = optionArray[option].split("|")
                var newOption = document.createElement("option");
                newOption.value = pair[0];
                newOption.innerHTML = pair[1];
                s2.options.add(newOption);
              }

            }
            else {
              console.log("Not retrived sources properly!ERROR")
            }
            //return category_wise_sources
          }
          catch (err) {
            //console.log("inside catch")
            //console.log(err.message)
            return null
          }
        }
      };
      xmlhttp.send();



    }




    function callClickCard(n) {
      n = parseInt(n)

      //console.log(document.getElementsByClassName("close")[n])
      document.getElementsByClassName("close")[n].style.display = 'block'
      document.getElementsByClassName("authorCard")[n].innerHTML = "<b>Author: </b>" + authors[n]
      document.getElementsByClassName("authorCard")[n].style.display = 'block'

      document.getElementsByClassName("sourceCard")[n].innerHTML = "<b>Source: </b>" + source_names[n]
      document.getElementsByClassName("sourceCard")[n].style.display = 'block'

      published_date_str = published[n].substring(0, 10)
      published_date_li = published_date_str.split('-')
      date_str = published_date_li[1] + "/" + published_date_li[2] + "/" + published_date_li[0]
      // console.log("DATE")
      // console.log(date_str)

      document.getElementsByClassName("dateCard")[n].innerHTML = "<b>Date: </b>" + date_str
      document.getElementsByClassName("dateCard")[n].style.display = 'block'

      url_link = urls[n]
      document.getElementsByClassName("linkCard")[n].innerHTML = "<a class=" + "\"see_post\"" + "href=" + "\"" + url_link + "\"" + " target=" + "\"_blank\"" + ">See Original Post</a>"
      document.getElementsByClassName("linkCard")[n].style.display = 'block'

      document.getElementsByClassName("descCard")[n].style.whiteSpace = "normal"
      document.getElementsByClassName("descCard")[n].innerHTML = desc[n]
      event.stopPropagation();

    }

    function showMore() {

      document.getElementsByClassName("show_button")[0].style.display = 'none'
      for (i = 5; i < no_of_articles; i++) {
        document.getElementsByClassName("each_article")[i].style.display = 'flex'
      }
      document.getElementsByClassName("show_button")[1].style.display = 'block'
    }
    function showLess() {
      document.getElementsByClassName("show_button")[1].style.display = 'none'

      for (i = 5; i < no_of_articles; i++) {
        document.getElementsByClassName("each_article")[i].style.display = 'none'

      }
      document.getElementsByClassName("show_button")[0].style.display = 'block'
    }

    function generateArticles(number_of_articles, start_number,show_more_articles) {
      console.log("generating cards")
      /*initial articles*/
      html = ''
      for (i = start_number; i < number_of_articles; i++) {
        if (i >= 5) {

          html = html + "<div class=\"each_article\" onclick=\"callClickCard(\'" + i + "\')\" style=\"display:none;\">"
        }
        else {
          html = html + "<div class=\"each_article\" onclick=\"callClickCard(\'" + i + "\')\">"
        }
        html = html + "<div class=\"cardcontent imgLeft\">"
        html = html + "<img class=\"images_for_search\" src=" + "\"" + urlToImages[i] + "\"" + ">"
        html = html + "</div>"
        html = html + "<div class=\"cardcontent textRight\">"
        html = html + "<div class=\"titleCard\">"
        html = html + "<div class=\"close\">&times;"
        html = html + "</div>"
        html = html + titles[i]
        html = html + "</div>"
        html = html + "<div class=\"authorCard\" style=\"display:none;\"></div>"
        html = html + "<div class=\"sourceCard\" style=\"display:none;\"></div>"
        html = html + "<div class=\"dateCard\" style=\"display:none;\"></div>"
        /*CROP CONTENT*/
        desc_words = desc[i].split(' ')
        no_of_spaces = desc_words.length - 1

        max_characters = 73
        cur_characters = 0
        croppedDesc = ''
        for (j = 0; j < desc_words.length; j++) {
          word = desc_words[j]
          if (word.length + cur_characters > max_characters) {
            croppedDesc = croppedDesc.trim() + "..."
            break
          }
          croppedDesc = croppedDesc + word + ' '
          cur_characters = cur_characters + word.length + 1

        }
        /*end crop content*/
        html = html + "<div class=\"descCard\">" + croppedDesc + "</div>"
        html = html + "<div class=\"linkCard\" style=\"display:none;\"></div>"
        html = html + "</div>"
        html = html + "</div>"
      }
      if (show_more_articles=="no" && start_number == 0 && number_of_articles <= 5) {
        //console.log("first")
        document.getElementById("news_articles").innerHTML = html
      }
      else if (show_more_articles=="yes" && start_number == 0 && number_of_articles == 5) {

        html = html + "<div class=\"button_article\"><button class=\"show_button\" onclick=\"showMore()\">Show More</button></div>"
        //console.log("second")
        document.getElementById("news_articles").innerHTML = html
      }
      else {
        //console.log("third")
        html = html + "<div class=\"button_article\"><button class=\"show_button\" onclick=\"showLess()\"style=\"display:none;\">Show Less</button></div>"
        document.getElementById("news_articles").innerHTML = document.getElementById("news_articles").innerHTML + html

      }




    }
    function populateSearchData(all_articles) {
      // console.log("INSIDE POPULATING")
      // console.log(all_articles)/*array of arrays*/

      parent_node = document.getElementById("news_articles")
      parent_node.innerHTML = ""
      parent_node.style.display = 'block'

      authors = all_articles[0]
      desc = all_articles[1]
      titles = all_articles[2]
      urls = all_articles[3]
      urlToImages = all_articles[4]
      published = all_articles[5]
      source_names = all_articles[6]
      src_ids = all_articles[7]
      contents = all_articles[8]
      no_of_articles = all_articles[0].length/*15 is max*/

      if (no_of_articles == 0) {
        parent_node.innerHTML = "No results"
        parent_node.style.fontSize = '14px';
        parent_node.style.marginLeft = '460px';
      }
      else {
        parent_node.style.marginLeft = '235px';
        if (no_of_articles < 5) {
          loop_count = no_of_articles
        }
        else {
          loop_count = 5
        }
        
        //console.log("Number of articles")
        //console.log(no_of_articles)
        if (no_of_articles <= 5) {
          generateArticles(loop_count, 0, "no")
        }
        else {
          generateArticles(loop_count, 0,"yes")
          //console.log("second loop")
          generateArticles(no_of_articles, 5,"no")
        }
        document.getElementsByClassName("close")[0].onclick = function (e) {
          n = 0
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[1].onclick = function (e) {
          n = 1
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }

        document.getElementsByClassName("close")[2].onclick = function (e) {
          n = 2
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[3].onclick = function (e) {
          n = 3
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }

        document.getElementsByClassName("close")[4].onclick = function (e) {
          n = 4
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }

        document.getElementsByClassName("close")[5].onclick = function (e) {
          n = 5
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }

        document.getElementsByClassName("close")[6].onclick = function (e) {
          n = 6
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[7].onclick = function (e) {
          n = 7
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[8].onclick = function (e) {
          n = 8
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[9].onclick = function (e) {
          n = 9
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[10].onclick = function (e) {
          n = 10
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[11].onclick = function (e) {
          n = 11
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[12].onclick = function (e) {
          n = 12
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[13].onclick = function (e) {
          n = 13
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }
        document.getElementsByClassName("close")[14].onclick = function (e) {
          n = 14
          document.getElementsByClassName("close")[n].style.display = 'none'
          document.getElementsByClassName("authorCard")[n].innerHTML = ''
          document.getElementsByClassName("authorCard")[n].style.display = 'none'

          document.getElementsByClassName("sourceCard")[n].style.display = 'none'
          document.getElementsByClassName("sourceCard")[n].innerHTML = ''

          document.getElementsByClassName("dateCard")[n].style.display = 'none'
          document.getElementsByClassName("dateCard")[n].innerHTML = ''

          document.getElementsByClassName("linkCard")[n].style.display = 'none'
          document.getElementsByClassName("linkCard")[n].innerHTML = ''

          document.getElementsByClassName("descCard")[n].style.whiteSpace = 'nowrap'
          desc_words = desc[n].split(' ')
          no_of_spaces = desc_words.length - 1

          max_characters = 73
          cur_characters = 0
          croppedDesc = ''
          for (j = 0; j < desc_words.length; j++) {
            word = desc_words[j]
            if (word.length + cur_characters > max_characters) {
              croppedDesc = croppedDesc.trim() + "..."
              break
            }
            croppedDesc = croppedDesc + word + ' '
            cur_characters = cur_characters + word.length + 1

          }

          document.getElementsByClassName("descCard")[n].innerHTML = croppedDesc

          e.stopPropagation();
        }

      }
    }


    function error_check() {

      from_date = document.getElementById("search_from").value
      to_date = document.getElementById("search_to").value
      from_date_li = from_date.split('-')
      to_date_li = to_date.split('-')

      from_year = from_date_li[0]
      from_month = from_date_li[1]
      from_date = from_date_li[2]

      to_year = to_date_li[0]
      to_month = to_date_li[1]
      to_date = to_date_li[2]

      // console.log(from_date)
      // console.log(to_date)
      if (from_year > to_year) {
        alert("Incorrect time")
        return 0
      }
      if (from_year == to_year && from_month > to_month) {
        alert("Incorrect time")
        return 0

      }
      if (from_year == to_year && from_month == to_month && from_date > to_date) {
        alert("Incorrect time")
        return 0

      }

      return 1
    }
    function appendFormData(event) {
      //event.preventDefault();
      //error_checking
      //console.log("INSIDE THIS")
      ans = error_check()
      if (ans == 0) {
        //document.getElementById("news_articles").style.display = 'none'
        //document.getElementById("news_articles").innerHTML = ''
        return
      }

      //event.preventDefault();

      var url = "/everything"
      var all_articles = []
      query_keyword = document.getElementById("search_keyword").value

      from_parameter = document.getElementById("search_from").value
      //console.log(from_parameter)
      to_parameter = document.getElementById("search_to").value
      source = document.getElementById("source").value

      url = url + "?" + "q=" + query_keyword + "&from_date=" + from_parameter + "&to_date=" + to_parameter + "&source_news=" + source

      xmlhttp = new XMLHttpRequest();
      xmlhttp.open("GET", url, true);
      xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xmlhttp.onreadystatechange = function () {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

          try {

            news_to_display = JSON.parse(xmlhttp.responseText)
            //console.log(news_to_display)
            if (news_to_display["error_data"]) {
              errorData = news_to_display.error_data
              //console.log(errorData.message)

              //throw errorData.message
              alert(errorData.message)
              return;

            }
            else {
              //console.log(news_to_display.data)
              all_articles = getData(news_to_display.data, 15)
              //console.log("all articles")
              //console.log(all_articles)
              if (all_articles.length > 0) {
                populateSearchData(all_articles)
              }

            }
          }
          catch (err) {
            
            //console.log("INSIDE CATCH BLOCK")
            // //console.log()
            // if(typeof(err)=="string" && err.includes("You are trying to request results too far in the past")){
            //   alert(err)
            //   //document.getElementById("news_articles").style.display='none'
            // }
            // return ;

          }
        }
      };

      xmlhttp.send();

    }
    function clearFormData() {
      /*On clicking reset button*/
      document.getElementById("search_keyword").value = ''
      document.getElementById("category").value = 'all'
      document.getElementById("source").value = 'all'
      getDate()
      document.getElementById("news_articles").style.display = 'none'
      populateSources()
      //document.getElementById("news_articles")
    }
    function getSearch() {
      /*On clicking search button*/
      document.getElementById("vertical_nav_bar").style.display = 'none'
      document.getElementById("other_nav_bar").style.display = 'block'

      document.getElementById("outer_card").style.display = 'none'
      document.getElementById("wordcloud").style.display = 'none'
      document.getElementById("cnn_news_card").style.display = 'none'
      document.getElementById("fox_news_card").style.display = 'none'
      document.getElementById("search_form").style.display = 'block'
      document.getElementById("news_articles").style.display = 'none'
      //document.getElementById("more_elements").style.display='none'

      /* Below three lines are written because navigating between pages, the input field values might persist/be there*/
      document.getElementById("search_keyword").value = ""
      document.getElementById("category").value = "all"
      document.getElementById("source").value = "all"
      getDate()
      populateSources()
      //console.log("Done calling date")
    }
    function getNews() {
      /*Function called on clicking Google News button*/
      document.getElementById("vertical_nav_bar").style.display = 'block'
      document.getElementById("other_nav_bar").style.display = 'none'

      document.getElementById("outer_card").style.display = 'block'
      document.getElementById("wordcloud").style.display = 'block'
      document.getElementById("cnn_news_card").style.display = 'block'
      document.getElementById("fox_news_card").style.display = 'block'
      document.getElementById("search_form").style.display = 'none'
      document.getElementById("news_articles").style.display = 'none'
      //document.getElementById("more_elements").style.display='none'
    }
    // This function takes the output of 'layout' above and draw the words
    // Wordcloud features that are THE SAME from one word to the other can be here
    function draw(words) {
      svg
        .append("g")
        .attr("transform", "translate(" + layout.size()[0] / 2 + "," + layout.size()[1] / 2 + ")")
        .selectAll("text")
        .data(words)
        .enter().append("text")
        .style("font-size", function (d) { return d.size; })
        .style("fill", "black")
        .attr("text-anchor", "middle")
        .style("font-family", "Impact")
        .attr("transform", function (d) {
          return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
        })
        .text(function (d) { return d.text; });
    }

    function createWordCloud(myWords) {
      // set the dimensions and margins of the graph
      var margin = { top: 3, right: 3, bottom: 3, left: 3 },
        width = 280 - margin.left - margin.right,
        height = 235 - margin.top - margin.bottom;

      // append the svg object to the body of the page
      svg = d3.select("#wordcloud").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

      // Constructs a new cloud layout instance. It run an algorithm to find the position of words that suits your requirements
      // Wordcloud features that are different from one word to the other must be here
      layout = d3.layout.cloud()
        .size([width, height])
        .words(myWords.map(function (d) { return { text: d.word, size: d.size }; }))
        .padding(4)        //space between words
        .rotate(function () { return ~~(Math.random() * 2) * 90; })
        .fontSize(function (d) { return d.size; })      // font size of words
        .on("end", draw);
      layout.start();

    }
    function loadPage() {
      document.getElementById("outer_card").style.display = 'block'
      document.getElementById("wordcloud").style.display = 'block'
      document.getElementById("cnn_news_card").style.display = 'block'
      document.getElementById("fox_news_card").style.display = 'block'
      document.getElementById("search_form").style.display = 'none'
      document.getElementById("news_articles").style.display = 'none'
      //document.getElementById("more_elements").style.display='none'

      //console.log("inside loadPage function")
      var url = "/index"
      xmlhttp = new XMLHttpRequest();
      xmlhttp.open("GET", url, true);
      xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xmlhttp.onreadystatechange = function () {
        //console.log(xmlhttp.readyState, "status")
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

          try {
            //(author, description, title, url,urlToImage, publishedAt and source with its inner keys) 
            var news_data = JSON.parse(xmlhttp.responseText)
            var headlines = news_data.general_headlines
            var cnn_headlines = news_data.specific_cnn_news
            var fox_headlines = news_data.specific_fox_news
            var word_cloud = news_data.word_cloud/*EDIT*/

            createWordCloud(word_cloud)

            // console.log("word cloud")
            // console.log(word_cloud)
            // console.log("ALL:")
            // console.log(headlines)
            // console.log("cnn")
            // console.log(cnn_headlines)
            // console.log("fox")
            // console.log(fox_headlines)
            // all headlines
            all_news_array = getData(headlines, 5)
            //console.log(all_news_array)

            cnn_news_array = getData(cnn_headlines, 4)
            //console.log(cnn_news_array)
            fox_news_array = getData(fox_headlines, 4)
            //console.log(fox_news_array)

            var images_for_headlines = all_news_array[4]
            var desc_for_headlines = all_news_array[1]
            var title_for_headlines = all_news_array[2]
            var content_for_headlines = all_news_array[8]
            var urls_for_headlines = all_news_array[3]

            var cnn_images_for_headlines = cnn_news_array[4]
            var cnn_desc_for_headlines = cnn_news_array[1]
            var cnn_title_for_headlines = cnn_news_array[2]
            var cnn_content_for_headlines = cnn_news_array[8]
            var cnn_urls_for_headlines = cnn_news_array[3]

            var fox_images_for_headlines = fox_news_array[4]
            var fox_desc_for_headlines = fox_news_array[1]
            var fox_title_for_headlines = fox_news_array[2]
            var fox_content_for_headlines = fox_news_array[8]
            var fox_urls_for_headlines = fox_news_array[3]

            //creating general headlines with slideshow format
            for (var img_count = 0; img_count < 5; img_count++) {

              var anchorObj2 = document.createElement("a")
              anchorObj2.setAttribute("href", urls_for_headlines[img_count])
              anchorObj2.setAttribute("target", "_blank")

              var imgObj = document.createElement("img")
              imgObj.setAttribute("class", "slideshow-images")
              // Add image object attributes 
              imgObj.setAttribute("src", images_for_headlines[img_count])

              anchorObj2.appendChild(imgObj)
              document.getElementsByClassName("mySlides")[img_count].appendChild(anchorObj2)

              var anchorObj2 = document.createElement("a")
              anchorObj2.setAttribute("href", urls_for_headlines[img_count])
              anchorObj2.setAttribute("target", "_blank")

              var titleObj = document.createElement("p")
              titleObj.setAttribute("style", "font-size: 12px;font-weight: bold;line-height:1.4;")
              // Add title object attributes 
              var title_text = document.createTextNode(title_for_headlines[img_count])

              titleObj.appendChild(title_text)
              //anchorObj2.appendChild(titleObj) uncomment
              //anchorObj2.appendChild(titleObj)

              //console.log(title_for_headlines[img_count])
              //console.log(titleObj)

              //document.getElementsByClassName("news-title")[img_count].appendChild(titleObj)

              var descObj = document.createElement("p")
              descObj.setAttribute("style", "font-size: 10px;line-height:1.4;")
              descObj.innerHTML = desc_for_headlines[img_count]
              //var desc_text = document.createTextNode(desc_for_headlines[img_count])
              //descObj.appendChild(desc_text)


              anchorObj2.appendChild(titleObj)
              anchorObj2.appendChild(descObj)
              document.getElementsByClassName("slideshow-content")[img_count].appendChild(anchorObj2)
              //anchorObj2.appendChild( document.getElementsByClassName("slideshow-content")[img_count])

            }
            showSlides(0);//should be outside the for loop

            //create cnn news
            var cnn_heading_obj = document.createElement("div")
            cnn_heading_obj.setAttribute("class", "heading_news")
            var cnn_text = document.createTextNode("CNN")
            cnn_heading_obj.appendChild(cnn_text)

            document.getElementById("cnn_news_card").appendChild(cnn_heading_obj)

            var hr_obj = document.createElement("hr")
            hr_obj.setAttribute("id", "cnn_heading_hr")
            document.getElementById("cnn_news_card").appendChild(hr_obj)

            var row_obj = document.createElement("div")
            row_obj.setAttribute("class", "row")

            for (var k = 0; k < 4; k++) {
              //console.log("in")

              col_obj = document.createElement("div")
              col_obj.setAttribute("class", "column")


              border_obj = document.createElement("div")
              border_obj.setAttribute("class", "border_stuff")

              anchorObj2 = document.createElement("a")
              anchorObj2.setAttribute("href", cnn_urls_for_headlines[k])
              anchorObj2.setAttribute("target", "_blank")

              card_obj = document.createElement("div")
              card_obj.setAttribute("class", "card")

              cnn_img_obj = document.createElement("img")
              cnn_img_obj.setAttribute("class", "cnn_images")
              cnn_img_obj.setAttribute("src", cnn_images_for_headlines[k])
              //console.log(cnn_img_obj)

              titleObj = document.createElement("p")
              titleObj.setAttribute("style", "font-size: 12px;font-weight: bold;color:black;text-align:center;line-height:1.4;")
              // Add title object attributes 
              title_text = document.createTextNode(cnn_title_for_headlines[k])
              //console.log(cnn_title_for_headlines[k])

              titleObj.appendChild(title_text)
              //anchorObj2.appendChild(titleObj) uncomment

              descObj = document.createElement("p")
              descObj.setAttribute("style", "font-size: 10px;color:black;text-align:center;line-height:1.6;")
              desc_text = document.createTextNode(cnn_desc_for_headlines[k])
              //console.log(cnn_desc_for_headlines[k])
              descObj.appendChild(desc_text)
              //console.log(descObj)

              //anchorObj2.appendChild(descObj) uncomment
              //console.log(anchorObj2)

              card_obj.appendChild(cnn_img_obj)
              card_obj.appendChild(titleObj)
              card_obj.appendChild(descObj)

              /*to make the entire card clickable*/
              anchorObj2.appendChild(card_obj)

              border_obj.appendChild(anchorObj2)
              //console.log(border_obj)
              col_obj.appendChild(border_obj)
              //console.log(col_obj)

              row_obj.appendChild(col_obj)
              //console.log(row_obj)

            }
            document.getElementById("cnn_news_card").appendChild(row_obj)
            //console.log(row_obj)

            //create fox news
            var fox_heading_obj = document.createElement("div")
            fox_heading_obj.setAttribute("class", "heading_news")
            var fox_text = document.createTextNode("Fox News")
            fox_heading_obj.appendChild(fox_text)

            document.getElementById("fox_news_card").appendChild(fox_heading_obj)

            hr_obj = document.createElement("hr")
            hr_obj.setAttribute("id", "fox_heading_hr")
            document.getElementById("fox_news_card").appendChild(hr_obj)

            row_obj = document.createElement("div")
            row_obj.setAttribute("class", "row")

            for (var m = 0; m < 4; m++) {
              //console.log("inside Fox news")

              col_obj = document.createElement("div")
              col_obj.setAttribute("class", "column")

              border_obj = document.createElement("div")
              border_obj.setAttribute("class", "border_stuff")

              anchorObj2 = document.createElement("a")
              anchorObj2.setAttribute("href", fox_urls_for_headlines[m])
              anchorObj2.setAttribute("target", "_blank")

              card_obj = document.createElement("div")
              card_obj.setAttribute("class", "card")

              fox_img_obj = document.createElement("img")
              fox_img_obj.setAttribute("class", "fox_images")
              fox_img_obj.setAttribute("src", fox_images_for_headlines[m])
              // console.log(fox_img_obj)
              // console.log(fox_urls_for_headlines[m])

              titleObj = document.createElement("p")
              titleObj.setAttribute("style", "font-size: 12px;font-weight: bold;color:black;text-align:center;line-height:1.4;")
              // Add title object attributes 
              title_text = document.createTextNode(fox_title_for_headlines[m])
              //console.log(fox_title_for_headlines[m])

              titleObj.appendChild(title_text)
              //anchorObj2.appendChild(titleObj)

              descObj = document.createElement("p")
              descObj.setAttribute("style", "font-size: 10px;color:black;text-align:center;line-height:1.6;")
              desc_text = document.createTextNode(fox_desc_for_headlines[m])
              //console.log(fox_desc_for_headlines[m])
              descObj.appendChild(desc_text)
              //console.log(descObj)

              //console.log(anchorObj2)

              card_obj.appendChild(fox_img_obj)
              card_obj.appendChild(titleObj)
              card_obj.appendChild(descObj)
              anchorObj2.appendChild(card_obj)

              border_obj.appendChild(anchorObj2)
              //console.log(border_obj)
              col_obj.appendChild(border_obj)
              //console.log(col_obj)
              row_obj.appendChild(col_obj)
              //console.log(row_obj)

            }
            document.getElementById("fox_news_card").appendChild(row_obj)
            //console.log(row_obj)
          }

          catch (err) {
            //console.log("Inside catch block");
            //console.log(err.message + " in " + xmlhttp.responseText);
            return;
          }

        }
      };
      xmlhttp.send();



    }
    window.onload = loadPage

  </script>
  <div id="vertical_nav_bar">

    <button class="active" onclick="getNews()" id="news_button">Google News</button>
    <button onclick="getSearch()" id="search_button">Search</button>

  </div>
  <div id="other_nav_bar" style="display: none;">
    <button onclick="getNews()" id="news_button">Google News</button>
    <button class="active" onclick="getSearch()" id="search_button">Search</button>

  </div>
  <div id="outer_card">

    <div id="slideshow-container">
      <div class="mySlides">
        <div class="slideshow-content">

        </div>
      </div>

      <div class="mySlides">
        <div class="slideshow-content">
        </div>
      </div>

      <div class="mySlides">
        <div class="slideshow-content">
        </div>
      </div>

      <div class="mySlides">
        <div class="slideshow-content">
        </div>
      </div>

      <div class="mySlides">
        <div class="slideshow-content">
        </div>
      </div>

    </div>
    <div id="wordcloud">

    </div>
  </div>
  <div id="cnn_news_card">

  </div>
  <div id="fox_news_card">

  </div>

  <div id="search_form" style="display:none;">
    <form id="search_form_Id" onsubmit="appendFormData(event);return false;">

      <div class="required_fields">

        Keyword <span class="asterick_required">*</span>
        <input type="text" id="search_keyword" name="SearchKeyword" size="15" required>


        From <span class="asterick_required">*</span>
        <input type="date" id="search_from" name="from_date" required>


        To <span class="asterick_required" required>*</span>
        <input type="date" id="search_to" name="to_date" required>


      </div>

      <div class="select_fields">
        Category
        <select id="category" name="category" onclick="populateSources()">
          <option value="all" selected>all</option>
          <option value="business">business</option>
          <option value="entertainment">entertainment</option>
          <option value="general">general</option>
          <option value="health">health</option>
          <option value="science">science</option>
          <option value="sports">sports</option>
          <option value="technology">technology</option>
        </select>
        Source
        <select id="source" name="source" style="max-width: 40%;">
          <option value="all" selected>all</option>
        </select>
      </div>
      <div id="wrapper">
        <input id="button1" type="submit" value="Search">
        <input id="button2" type="button" value="Clear" onclick="clearFormData()">
      </div>
    </form>
  </div>
  <div id="news_articles" style="display: none;">


  </div>


</body>

</html>